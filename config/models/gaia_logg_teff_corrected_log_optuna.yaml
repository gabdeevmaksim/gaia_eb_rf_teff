# ============================================================================
# Gaia colours + logg → log(Teff) with Optuna hyperparameter optimization
# ============================================================================
# Predicts log10(Teff) using Gaia photometry and surface gravity (logg).
# Use this model when logg is available (Gaia or from a separate logg predictor).
# ============================================================================

model:
  name: Gaia + logg → Teff (Corrected, Log, Optuna)
  id_prefix: rf_gaia_logg_teff_corrected_log_optuna
  description: Temperature prediction using Gaia colors and logg with polynomial
    correction for hot stars, log-transformed target, and Optuna optimization

teff_correction:
  enabled: true
  target_column: teff_gaia
  threshold: 10000
  coefficients_file: teff_correction_coeffs_deg2.pkl

target_transform: log

data:
  source_file: eb_unified_photometry.parquet
  source_format: parquet
  source_location: raw
  target: teff_gaia_corrected
  features:
    - g
    - bp
    - rp
    - bp_rp
    - g_bp
    - g_rp
    - logg_gaia
  id_column: source_id

preprocessing:
  missing_value: -999.0
  filters:
    teff_gaia: [2500, 50000]
    logg_gaia: [0.0, 6.0]   # Physical range (dex); excludes missing
  drop_missing: true

training:
  test_size: 0.2
  random_state: 42

optuna_optimization:
  enabled: true
  n_trials: 150
  timeout: null
  max_samples: null   # Reduce RAM use in Docker; null for full data
  stop_if_no_improvement_for: 15   # Stop after this many trials without improving best; null to disable
  search_space:
    n_estimators: [200, 500, 10]
    max_depth: [15, 25]
    min_samples_split: [3, 10]
    min_samples_leaf: [2, 8]
    max_features: [sqrt, log2]

hyperparameters:
  n_estimators: 300
  max_depth: 20
  min_samples_split: 5
  min_samples_leaf: 2
  max_features: sqrt
  random_state: 42
  n_jobs: -1
  verbose: 0

feature_engineering:
  enabled: false

clustering:
  enabled: false

output:
  save_model: true
  save_predictions: true
  save_test_predictions: true
  models_dir: models
  predictions_dir: data/predictions

validation:
  create_plots: true
  n_temp_bins: 5
  target_info:
    name: Temperature
    unit: K
    short: Teff
